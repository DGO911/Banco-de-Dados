-- crianto massa de veiculos para cruzar com terminal

select replace(concat(concat('Insert into GTW_VEICULO_TERMINAL values ($182$,$',VEI_CODIGO), '$);'), '$', '''') 
from GTW_VEICULO_TERMINAL where ter_codigo in 
(Select ter_codigo from 
(SELECT T.TER_IDENTIFICACAO_EMPRESA,T.TER_CODIGO,F.FIL_NOME,COUNT(*)NUMERO_DE_VEICULOS_TERMINAL 
FROM GTW_VEICULO_TERMINAL V
JOIN GTW_TERMINAL T ON V.TER_CODIGO=T.TER_CODIGO
JOIN GTW_FILIAL F ON F.FIL_CODIGO=T.FIL_CODIGO
where F.FIL_NOME like '%Santa Luzia%'
GROUP BY T.TER_IDENTIFICACAO_EMPRESA,T.TER_CODIGO,F.FIL_NOME
ORDER BY 4 DESC) where rownum = 1);

-- criando massa de usuario para cruzar com terminal

select replace(concat(concat('Insert into GTW_USUARIO_TERMINAL values ($',USU_CODIGO), '$,$182$);'), '$', '''') 
from GTW_USUARIO_TERMINAL where ter_codigo in 
(Select ter_codigo from 
(SELECT T.TER_IDENTIFICACAO_EMPRESA,T.TER_CODIGO,F.FIL_NOME,COUNT(*)NUMERO_DE_USUARIOS_TERMINAL 
FROM GTW_USUARIO_TERMINAL U
JOIN GTW_TERMINAL T ON U.TER_CODIGO=T.TER_CODIGO
JOIN GTW_FILIAL F ON F.FIL_CODIGO=T.FIL_CODIGO
WHERE F.FIL_NOME LIKE '%Eldorado%'
GROUP BY T.TER_IDENTIFICACAO_EMPRESA,T.TER_CODIGO,F.FIL_NOME
ORDER BY 4 DESC) where rownum = 1);

